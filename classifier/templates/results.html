
{% extends "shareable/html/base.html" %}
{%load static%}
{%block css%}
<link rel="stylesheet" href="{% static 'classifier/css/results.css' %}">
{%endblock%}
{%block js%}
<script src="{% static 'database/js/votecount.js' %}"></script>

<script src="{%static 'classifier/js/modifyResult.js'%}"></script>
{%endblock%}
{%block app_layout_content_before%}
<div id="alert" class="alert alert-warning alert-dismissible fade hide" role="alert">
    <div class="text">

    </div>
    <button id="alertClose" type="button" class="btn-close" ></button>
</div>
{%endblock%}
{%block content%}
{% load custom_filter %}
<form class="table-responsive">
    
    <input id="submit" class="btn-primary btn" type="submit" name="Submit" value="Submit Changes">
    <table class="table table-borderless">
        
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">filename</th>
            <th style="white-space: nowrap;" scope="col">scientific Name</th>
            <th style="white-space: nowrap;" scope="col">Plant Type</th>   
            <th scope="col">latitude</th>
            <th scope="col">longtitude</th>
        </tr>
        </thead>
        <tbody>
        {% for objects in data %}
        <tr >
            <th scope="row" data-bs-toggle="collapse" href="#collapse{{forloop.counter}}" role="button" aria-expanded="false" aria-controls="collapse{{forloop.counter}}">{{forloop.counter}}</th>
            <td data-bs-toggle="collapse" href="#collapse{{forloop.counter}}" role="button" aria-expanded="false" aria-controls="collapse{{forloop.counter}}">
                <div class="cut-text">{{objects.filename}} </div>
            </td>
            <td >
                <select name="scientificName" >
                    {% with objects.scientificName.scientificName|split:" " as scientificName %}
                   
                    <option value="{{objects.id}}-{{objects.scientificName.scientificName}}" selected>  
                        <p style="font-style: italic;"> {{ scientificName.0 }} {{ scientificName.1 }}</p>
                    </option>
                    {% endwith %}
                    {% for plant in plants %}
                    {% if plant.0 != objects.scientificName.scientificName%}
                    {% with plant.0|split:" " as scientificName %}

                    <option value="{{objects.id}}-{{plant.0}}">
                        <p style="font-style: italic;"> {{ scientificName.0 }} {{ scientificName.1 }}</p>
                    </option>
                    
                    {% endwith %}
                    {% endif %}
                    {% endfor %}

                    
                    
                </select>
                <!-- {{objects.scientificName.scientificName}} -->
            </td>
            <td data-bs-toggle="collapse" href="#collapse{{forloop.counter}}" role="button" aria-expanded="false" aria-controls="collapse{{forloop.counter}}">{{objects.scientificName.invasiveType}}</td>
            <td>
                <input type="text" id="latitude" name="latitude" value="{{objects.latitude}}">
            </td>
            <td>
                <input type="text" id="longtitude" name="longtitude" value="{{objects.longtitude}}">
            </td>
        </tr>
        <tr>
            <td colspan="6" class="py-0" >
                {% if forloop.counter == 1%}
                <div class="collapse show" id="collapse{{forloop.counter}}">
                {% else%}
                <div class="collapse" id="collapse{{forloop.counter}}">
                {% endif%}    
                
                    <div class="card mb-3" >
                        <div class="row g-0">
                            <div class="col-1 vote">
                                {% checkuservotes objects.id user.id "up" as result%}
                                {%if result%}
                                <span id="up-{{objects.id}}" class="material-symbols-outlined up vote-icon activate">
                                {%else%}
                                <span id="up-{{objects.id}}" class="material-symbols-outlined up vote-icon">
                                {%endif%}    
                                    arrow_drop_up
                                    <div class="popup"> 
                                        Up vote if the <br>result is <b> Accurate </b>
                                    </div>
                                </span>
                                
                                <span class="text"> 
                                    {{objects.points}}
                                </span>
                                
                                {% checkuservotes objects.id user.id "down" as result%}
                                {%if result%}
                                <span id="down-{{objects.id}}" class="material-symbols-outlined down vote-icon activate">
                                {%else%}
                                <span id="down-{{objects.id}}" class="material-symbols-outlined down vote-icon">
                                {%endif%}
                                    arrow_drop_down
                                    <div class="popup"> 
                                        Down vote if the <br> result is <b> Inaccurate </b>
                                    </div>
                                </span>
                             </div>
                            <div class="col-md-8 iasImageCol">
                                <img src="/blobstorage/raw/{{objects.requestnum.username}}/{{objects.filename}}" class="img-fluid rounded-start iasImage " alt="...">
                            </div>
                            <div class="col-md">
                                <div class="card-body description">
                                    {% with objects.scientificName.scientificName|split:" " as scientificName %}
                                    <h5 class="card-title plantName"><p style="display: inline ;font-style: italic;"> {{ scientificName.0 }} {{ scientificName.1 }}</p> ({{objects.scientificName.localName}})</h5>
                                    {% endwith %}
                                    <p class="card-text justify">
                                        <span class="identifier">Family: </span>
                                        {{objects.scientificName.family|safe}} <br>

                                        <span class="identifier">Description: </span>
                                        {{objects.scientificName.description|safe}} <br>

                                        <span class="identifier">Habitat: </span>
                                        {{objects.scientificName.habitat|safe}} <br>

                                        <span class="identifier">Propagation: </span>
                                        {{objects.scientificName.propagation|safe}} <br>

                                        <span class="identifier">Native Range: </span>
                                        {{objects.scientificName.nativeRange|safe}} <br>

                                        <span class="identifier">Comments: </span>
                                        {{objects.scientificName.comments|safe}} <br>

                                        <span class="identifier">Control: </span>
                                        {{objects.scientificName.control|safe}} <br>

                                        <span class="identifier">Link: </span>
                                        {{objects.scientificName.link|safe}} <br>
                                        
                                    </p>

                                    <div class="plantWrapper">   
                                        {% loadPlantImage objects.scientificName.scientificName as plantImage%}
                                        {% for image in plantImage%}
                                          <div class=" plantImage">
                                            <img src="/blobstorage/getplant/{{image.plantInformation.scientificName}}/{{image.filename}}" class="card-img" alt="...">
                                          </div>
                                        {%endfor%}
                                    </div>

                                    <p class="card-text date">
                                        <small class="text-muted">
                                            Uploaded: {{objects.requestnum.date}}
                                        </small>
                                    </p>
                                    <p class="card-text date">    
                                        <small class="text-muted">
                                            Last Updated: {{objects.scientificName.date}}
                                        </small>
                                    </p>

                                    

                                </div>
                            </div>
                        </div>
                    </div>   
                </div>
            </td> 
        </tr>
        {% endfor %}
        </tbody>
    </table>
</form>

{%endblock%}
